<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first Three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="js\three.js\build\three.js"></script>
		<script>
			var scene = new THREE.Scene();
			var color = new THREE.Color("rgb(255,255,255)");
			scene.background = color;
			var mousePosX = 0;
			var mousePosY = 0;
			var particles = [];
			var counter = 0;
			var counterP = 0;
			shadowLight = new THREE.DirectionalLight(0xffffff, .8);
			shadowLight.position.set(1, 1, 1);
 			scene.add(shadowLight);

			function getRandomColor() {
  				var letters = '0123456789ABCDEF';
      				var color = '#';
    				for (var i = 0; i < 6; i++ ) {
        				color += letters[Math.floor(Math.random() * 16)];
        			}
        			return color;
    			}

			function createParticle() {
				var randomL = Math.random();
				var randomW = Math.random();
				var randomT = Math.random();
				var geometry = new THREE.BoxGeometry(randomL*100, randomW*100, randomT * 100);
				var color = new THREE.Color( getRandomColor() );
				var material = new THREE.MeshPhongMaterial({shading: THREE.FlatShading});
				material.color = color;
				var cube = new THREE.Mesh(geometry, material);
				cube.position.x = 1000+randomL * 500;
				cube.position.y = -1000+randomW * 2000;
				return cube;
			}

			function main() {
				var texture = new THREE.TextureLoader().load("/images/dog.jpg");
				texture.wrapS = THREE.RepeatWrapping;
				texture.wrapT = THREE.RepeatWrapping;
 				 light = new THREE.HemisphereLight(0xffffff, 0xffffff, .3)
 				
				var camera = new THREE.PerspectiveCamera(100, window.innerWidth / window.innerHeight, 0.1, 1000);

				var renderer = new THREE.WebGLRenderer();
				renderer.setSize(window.innerWidth, window.innerHeight);
				document.body.appendChild(renderer.domElement);
				var geometry = new THREE.CubeGeometry(100, 100,100);
				var material = new THREE.MeshBasicMaterial({map: texture});
				// material.wireframe = true;
				var cube = new THREE.Mesh(geometry, material);
				cube.position.x = -700;
				cube.position.y=0;
				scene.position.z = 50;
				scene.add(cube);
				scene.add(light);

				camera.position.z = 1000;
				// camera.lookAt(new THREE.Vector3(0,0,0));
				var speedX = 0;
				var speedY = 0;
				window.addEventListener("mousemove", handleMouseMove) ;
				function handleMouseMove(event) {
					mousePosX = event.clientX;
					mousePosY = event.clientY;
				}
				var render = function() {
					if (counter % 10 == 0) {

						particles.push(createParticle());
						for (var i = 0; i < particles.length; i++) {
							scene.add(particles[i]);
						}
						counterP++;
					}
					requestAnimationFrame( render );
					cube.position.x = (mousePosX-1500);
					cube.position.y=-(mousePosY -500) * 2.5;

					renderer.render(scene, camera);
					for (var i = 0; i < particles.length; i++) {
							particles[i].position.x -= 10;
							particles[i].rotation.x += 0.05;
							particles[i].rotation.y += 0.05;
							particles[i].rotation.z += 0.05;
							if (particles[i].position <= -2000) {
								scene.remove(particles[i]);
							}
					}
					counter++;
				};
				render();
			}





			main();
		</script>
	</body>
</html>